<?xml version="1.0" encoding="UTF-8"?>

<!-- ====================================================================== -->
<!--  Apache Ant build script for building the Robocode setup file          -->
<!-- ====================================================================== -->

<project name="build" default="archive">
  <description>Apache Ant build script for building the Robocode archive files</description>

  <!-- ====================================== -->
  <!-- Global properties                      -->
  <!-- ====================================== -->

  <!-- Read out the version from the versions.txt -->
  <loadfile property="version" srcfile="../robocode/resources/versions.txt">
    <filterchain>
      <headfilter lines="1"/>
      <replacestring from="Version " to=""/>
      <replacestring from=" " to="-"/>
      <striplinebreaks/>
    </filterchain>
  </loadfile>

  <!-- Disable debug information when compiling -->  
  <property name="debug" value="true"/>
  <condition property="java.debug" value="on" else="off">
    <istrue value="${debug}"/>
  </condition>  
  <condition property="ikvm.debug" value="-debug" else="">
    <istrue value="${debug}"/>
  </condition>  
  <condition property="vs.debug" value="-debug" else="">
    <istrue value="${debug}"/>
  </condition>
  
  <!-- Sign assemblies -->  
  <property name="sign" value="false"/>
  <condition property="ikvm.sign" value="-keyfile:${src.root}/nrobocode.snk" else="">
    <istrue value="${sign}"/>
  </condition>

  <!-- The build folder -->
  <property name="build" location="build"/>

  <!-- The source folders -->
  <property name="src.root" location=".."/>
  <property name="src.robocode" location="../robocode"/>
  <property name="src.robocodeui" location="../robocodeui"/>
  <property name="src.extract" location="../robocodeextract"/>
  <property name="src.autoextract" location="../autoextract"/>
  <property name="src.robots" location="../robocodeextract/robots"/>
  <property name="src.roborumble" location="../roborumble"/>
  <property name="src.cachecleaner" location="../robocode/ar"/>
  <property name="src.nrobocode" location="../nrobocode"/>
  <property name="src.nrobocodeui" location="../nrobocodeui"/>
  <property name="ikvm" location="../nrobocode/ikvm"/>
  <property name="csc" location="C:/Windows/Microsoft.NET/Framework/v2.0.50727/csc.exe"/>
  <property name="vs9" location="C:/Program Files/Microsoft Visual Studio 9.0/Common7/IDE/devenv.exe"/>

  <!-- License file -->
  <property name="license.file" location="${src.extract}/license/cpl-v10.html"/>

  <!-- Versions file -->
  <property name="versions.file" location="${src.robocode}/resources/versions.txt"/>

  <!-- The output archive files -->
  <property name="setup.archive" value="robocode-setup-${version}.jar"/>
  <property name="sources.archive" value="robocode-src-${version}.zip"/>

  <!-- ====================================== -->
  <!-- Default Excludes                       -->
  <!-- ====================================== -->

  <defaultexcludes add="build.xml"/>	 <!-- Ant build scripts -->
  <defaultexcludes add="**/.*/**"/>      <!-- Eclipse configuration folders -->
  <defaultexcludes add="**/*.bak"/>      <!-- Windows backup files -->
  <defaultexcludes add="**/Thumbs.db"/>  <!-- Windows thumbs databases -->
  <defaultexcludes add="**/~*"/>         <!-- Unix backup files -->
  <defaultexcludes add="**/.*"/>         <!-- Hidden unix file types -->
  <defaultexcludes add="**/_*.java"/>    <!-- Java files to hide in Javadoc -->

  <!-- ====================================== -->
  <!-- Target: init                           -->
  <!-- ====================================== -->
  <target
      name="init"
      description="Initializes the build">

  	<echo message="Initializes the build..."/>

  	<!-- Create timestamp -->
  	<tstamp/>

  	<!-- Create folder for containing build files -->
  	<mkdir dir="${build}/libs"/>
  </target>

  <!-- ====================================== -->
  <!-- Target: archive                        -->
  <!-- ====================================== -->
  <target
      name="archive"
      description="Build the Robocode distribution files"
      depends="archive.setup, archive.sources"
  />

  <!-- ====================================== -->
  <!-- Target: archive.setup                  -->
  <!-- ====================================== -->
  <target
      name="archive.setup"
      description="Build the Robocode setup archive"
      depends="clean, extract.jar, compile.autoextract">

    <echo message="Building Robocode setup archive (${setup.archive})..."/>

    <!-- Create the Robocode setup archive -->
	<jar destfile="${build}/${setup.archive}">
      <!-- Specify files to include -->
      <fileset dir="${build}" includes="robocode/AutoExtract.class"/>  <!-- Auto extract class -->
      <fileset file="${build}/extract.jar"/>  <!-- extract.jar file -->
      <!-- Set the main class of the manifest -->
      <manifest>
        <attribute name="Implementation-Title" value="Robocode installer"/>
	    <attribute name="Implementation-Version" value="v${version}, ${TODAY}"/> 
	    <attribute name="Implementation-Vendor" value="Mathew A. Nelson, Flemming N. Larsen"/>
        <attribute name="Main-Class" value="robocode.AutoExtract"/>
      </manifest>
    </jar>
  </target>

  <!-- ====================================== -->
  <!-- Target: archive.sources                -->
  <!-- ====================================== -->
  <target
  	  name="archive.sources"
	  description="Zip all source files">
	
	<echo message="Building Robocode sources archive (${sources.archive})..."/>
	
	<zip
        destfile="${build}/${sources.archive}"
        basedir=".."
        includes="autoextract/**, build/*, robocode/**, robocodeui/**, robocodeextract/**, roborumble/**"
        excludes="build/build, **/bin/**, **/.svn/**"
        defaultexcludes="no"
    />
  </target>

  <!-- ====================================== -->
  <!-- Target: libs                           -->
  <!-- ====================================== -->
  <target
      name="libs"
      description="Build the jars and dll"
      depends="nrobocode, robocode.exe"
  />
    <!--
    ,
     -->

  <!-- ====================================== -->
  <!-- Target: compile.robocode               -->
  <!-- ====================================== -->
  <target
      name="compile.robocode"
      description="Compile Robocode"
  	  depends="init"
      unless="robocode.uptodate"> 

    <echo message="Compiling Robocode..."/>
 
  	<!-- Copy libs into the build folder -->
  	<copy file="${src.extract}/libs/codesize.jar" toDir="${build}/libs"/>
 
    <!-- Compile Robocode -->
    <compile srcdir="${src.robocode}" destdir="${build}" classpath="${build}/libs/codesize.jar"/>

    <!-- Flag that Robocode has been built -->
    <touch file="${build}/.robocode_build"/>
  </target>

  <uptodate property="robocode.uptodate" targetfile="${build}/.robocode_build">
    <srcfiles dir="${src.robocode}/robocode"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: compile.robocodeui             -->
  <!-- ====================================== -->
  <target
      name="compile.robocodeui"
      description="Compile Robocode UI"
  	  depends="init, compile.robocode, robocode.jar"
      unless="robocodeui.uptodate"> 

    <echo message="Compiling Robocode UI..."/>
 
  	<!-- Copy libs into the build folder -->
  	<copy file="${src.extract}/libs/codesize.jar" toDir="${build}/libs"/>

    <!-- Compile Robocode UI -->
    <compile srcdir="${src.robocodeui}" destdir="${build}" classpath="${build}/libs/codesize.jar;${build}/libs/robocode.jar"/>

    <!-- Flag that Robocode has been built -->
    <touch file="${build}/.robocodeui_build"/>
  </target>

  <uptodate property="robocodeui.uptodate" targetfile="${build}/.robocodeui_build">
    <srcfiles dir="${src.robocodeui}/robocodeui"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: compile.robots                 -->
  <!-- ====================================== -->
  <target
      name="compile.robots"
      description="Compile robots"
      depends="init, compile.robocode"
      unless="robots.uptodate">

    <echo message="Compiling robots..."/>

    <!-- Compile robots -->
    <compile srcdir="${src.extract}/robots" destdir="${build}/robots" classpath="${build}"/>

    <!-- Flag that robots have been built -->
    <touch file="${build}/.robots_build"/>
  </target>

  <uptodate property="robots.uptodate" targetfile="${build}/.robots_build">
    <srcfiles dir="${src.robots}"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: compile.autoextract            -->
  <!-- ====================================== -->
  <target
      name="compile.autoextract"
      description="Compile AutoExtract"
  	  depends="init"
      unless="autoextract.uptodate">

    <echo message="Compiling AutoExtract..."/>

    <!-- Compile AutoExtract -->
    <compile srcdir="${src.autoextract}" destdir="${build}"/>
  </target>

  <uptodate property="autoextract.uptodate" targetfile="${build}/robocode/AutoExtract.class">
    <srcfiles dir="${src.autoextract}"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: compile.roborumble             -->
  <!-- ====================================== -->
  <target
      name="compile.roborumble"
      description="Compile RoboRumble"
  	  depends="init"
      unless="roborumble.uptodate"> 

    <echo message="Compiling RoboRumble..."/>
 
  	<!-- Copy libs into the build folder -->
  	<copy file="${src.extract}/libs/codesize.jar" toDir="${build}/libs"/>

  	<!-- Compile RoboRumble -->
    <compile srcdir="${src.roborumble}" destdir="${build}" classpath="${build}/libs/codesize.jar"/>

    <!-- Flag that RoboRumble has been built -->
    <touch file="${build}/.roborumble_build"/>
  </target>

  <uptodate property="roborumble.uptodate" targetfile="${build}/.roborumble_build">
    <srcfiles dir="${src.roborumble}/roborumble"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: compile.cachecleaner           -->
  <!-- ====================================== -->
  <target
      name="compile.cachecleaner"
      description="Compile CacheCleaner"
      depends="init, robocode.jar"
      unless="cachecleaner.uptodate">

    <echo message="Compiling CacheCleaner..."/>

    <!-- Compile CacheCleaner -->
    <compile srcdir="${src.cachecleaner}" destdir="${build}" classpath="${build}/libs/robocode.jar"/>

    <!-- Flag that CacheCleaner has been built -->
    <touch file="${build}/.cachecleaner_build"/>
  </target>

  <uptodate property="cachecleaner.uptodate" targetfile="${build}/.cachecleaner_build">
    <srcfiles dir="${src.cachecleaner}"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: robocode.jar                   -->
  <!-- ====================================== -->
  <target
      name="robocode.jar"
      description="Build robocode.jar"
      depends="init, compile.robocode"
      unless="robocode.jar.uptodate">

    <echo message="Building robocode.jar..."/>

    <!-- Create the robocode.jar file -->
    <jar destfile="${build}/libs/robocode.jar">
      <!-- Specify files to include -->
      <fileset dir="${build}" includes="robocode/**">   <!-- Class files -->
        <exclude name="robocode/AutoExtract.class"/>    <!-- Exclude AutoExtract.class -->
      </fileset>
      <fileset dir="${src.robocode}" includes="resources/**"/>  <!-- Resource files -->
      <fileset file="${license.file}"/>                         <!-- License file -->
      <!-- Set the main class of the manifest -->
      <manifest>
        <attribute name="Implementation-Title" value="Robocode"/>
	    <attribute name="Implementation-Version" value="v${version}, ${TODAY}"/> 
	    <attribute name="Implementation-Vendor" value="Mathew A. Nelson, Flemming N. Larsen, and other Robocode contributors"/>
        <attribute name="Main-Class" value="robocode.Robocode"/>
      </manifest>
    </jar>
  </target>

  <uptodate property="robocode.jar.uptodate" targetfile="${build}/libs/robocode.jar">
    <srcfiles dir="${src.robocode}"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: robocodeui.jar                   -->
  <!-- ====================================== -->
  <target
      name="robocodeui.jar"
      description="Build robocodeui.jar"
      depends="init, compile.robocodeui"
      unless="robocodeui.jar.uptodate">

    <echo message="Building robocodeui.jar..."/>

    <!-- Create the robocodeui.jar file -->
    <jar destfile="${build}/libs/robocodeui.jar">
      <!-- Specify files to include -->
      <fileset dir="${build}" includes="robocodeui/**"/>   <!-- Class files -->
      <fileset dir="${src.robocodeui}" includes="resources/**"/>  <!-- Resource files -->
      <fileset file="${license.file}"/>                         <!-- License file -->
      <!-- Set the main class of the manifest -->
      <manifest>
        <attribute name="Implementation-Title" value="Robocode UI"/>
	    <attribute name="Implementation-Version" value="v${version}, ${TODAY}"/> 
	    <attribute name="Implementation-Vendor" value="Mathew A. Nelson, Flemming N. Larsen, and other Robocode contributors"/>
      </manifest>
    </jar>
  </target>

  <uptodate property="robocodeui.jar.uptodate" targetfile="${build}/libs/robocodeui.jar">
    <srcfiles dir="${src.robocodeui}"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: extract.jar                    -->
  <!-- ====================================== -->
  <target
      name="extract.jar"
      description="Build extract.jar"
      depends="init, robocode.jar, robocodeui.jar, roborumble.jar, compile.robots, cachecleaner.jar, javadoc"
      unless="extract.jar.uptodate">

    <echo message="Building extract.jar..."/>

    <!-- Create the extract.jar file -->
    <jar destfile="${build}/extract.jar">
      <!-- Specify files to include -->
      <fileset dir="${src.extract}">      <!-- Files from the extract folder -->
        <exclude name="build/**"/>        <!-- Exclude build files (if any) -->
      </fileset>
      <fileset dir="${src.roborumble}">   <!-- Files from the roborumble folder -->
        <include name="*.bat"/>           <!-- Windows batch files -->
        <include name="*.sh"/>            <!-- Shell files (Mac, Linux, and similar) -->
      	<include name="config/*"/>        <!-- Configuration files -->
      </fileset>
      <fileset dir="${build}">
        <include name="libs/robocode.jar"/>      <!-- Builded robocode.jar -->
        <include name="libs/robocodeui.jar"/>    <!-- Builded robocodeui.jar -->
        <include name="libs/roborumble.jar"/>    <!-- Builded roborumble.jar -->
        <include name="libs/cachecleaner.jar"/>  <!-- Builded cachecleaner.jar -->
        <include name="javadoc/**"/>             <!-- Builded javadoc files -->
        <include name="robots/**"/>              <!-- Builded robots -->
      </fileset>
      <fileset file="${versions.file}"/>  <!-- Versions file -->
    </jar>
  </target>

  <uptodate property="extract.jar.uptodate" targetfile="${build}/extract.jar">
    <srcfiles dir="${src.extract}" excludes="build/**"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: roborumble.jar                 -->
  <!-- ====================================== -->
  <target
      name="roborumble.jar"
      description="Build roborumble.jar"
      depends="init, compile.robocode, compile.roborumble"
      unless="roborumble.jar.uptodate">

    <echo message="Building roborumble.jar..."/>

    <!-- Create the roborumble.jar file -->
    <jar destfile="${build}/libs/roborumble.jar">
      <!-- Specify files to include -->
      <fileset dir="${build}" includes="roborumble/**"/>  <!-- Class files -->
      <fileset file="${license.file}"/>                   <!-- License file -->
      <!-- Set the main class of the manifest -->
      <manifest>
        <attribute name="Implementation-Title" value="RoboRumble@Home"/>
	    <attribute name="Implementation-Version" value="v${version}, ${TODAY}"/> 
	    <attribute name="Implementation-Vendor" value="Albert Pérez, Flemming N. Larsen, and other Robocode contributors"/>
        <attribute name="Main-Class" value="roborumble.RoboRumbleAtHome"/>
      </manifest>
    </jar>
  </target>

  <uptodate property="roborumble.jar.uptodate" targetfile="${build}/libs/roborumble.jar">
    <srcfiles dir="${src.roborumble}"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: cachecleaner.jar               -->
  <!-- ====================================== -->
  <target
      name="cachecleaner.jar"
      description="Build cachecleaner.jar"
      depends="init, compile.cachecleaner"
      unless="cachecleaner.jar.uptodate">

    <echo message="Building cachecleaner.jar..."/>

    <!-- Create the cachecleaner.jar file -->
    <jar destfile="${build}/libs/cachecleaner.jar">
      <!-- Specify files to include -->
      <fileset dir="${build}" includes="ar/**"/>  <!-- Class files -->
      <!-- Set the main class of the manifest -->
      <manifest>
        <attribute name="Implementation-Title" value="CacheCleaner for Robocode"/>
	    <attribute name="Implementation-Version" value="v${version}, ${TODAY}"/> 
	    <attribute name="Implementation-Vendor" value="AaronR"/>
        <attribute name="Main-Class" value="ar.robocode.cachecleaner.CacheCleaner"/>
      </manifest>
    </jar>
  </target>

  <uptodate property="cachecleaner.jar.uptodate" targetfile="${build}/libs/cachecleaner.jar">
    <srcfiles dir="${src.cachecleaner}"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: javadoc                        -->
  <!-- ====================================== -->
  <target
      name="javadoc"
      description="Generate javadoc"
  	  depends="init"
      unless="javadoc.uptodate">

    <echo message="Generating javadoc..."/>

    <!-- Generate the javadoc documentation -->
    <javadoc
        destdir="${build}/javadoc"
        sourcepath="${src.robocode}"
    	excludepackagenames="robocode.*, codesize.*, ar.*"
        windowtitle="Robocode ${version} API"
    	link="http://java.sun.com/j2se/1.5.0/docs/api">
      <fileset dir="${src.robocode}" defaultexcludes="yes">
        <include name="robocode/*.java"/>
      	<include name="robocode/util/Utils.java"/>
      	<include name="robocode/control/*.java"/>
      </fileset>
      <doctitle><![CDATA[<h1>Robocode ${version} API</h1>]]></doctitle>
    </javadoc>

    <!-- Flag that javadoc has been built -->
    <touch file="${build}/.javadoc_build"/>
  </target>

  <uptodate property="javadoc.uptodate" targetfile="${build}/.javadoc_build">
    <srcfiles dir="${src.robocode}" includes="**/*.java"/>
  </uptodate>

  <!-- ====================================== -->
  <!-- Target: install                        -->
  <!-- ====================================== -->
  <target
      name="install"
      description="Install Robocode"
      depends="archive.setup">

    <echo message="Installing Robocode..."/>

    <!-- Run the Robocode setup file -->
    <java jar="${setup.file}" fork="true"/>
  </target>

  <!-- ====================================== -->
  <!-- Target: quick-install                  -->
  <!-- ====================================== -->
  <target
      name="quick-install"
      description="Quick install Robocode"
      depends="extract.jar">

    <echo message="Quick-installing Robocode..."/>

    <!-- Ask user where to install Robocode -->
    <input
        message="To which folder do you want to install Robocode?"
        addproperty="install.dir"/>

    <!-- Create the installation folder -->
    <mkdir dir="${install.dir}"/>

    <!-- Extract the extract.jar into the installation folder -->
    <unjar src="${build}/extract.jar" dest="${install.dir}"/>
  </target>

  <!-- ====================================== -->
  <!-- Target: clean                          -->
  <!-- ====================================== -->

  <!-- Clean up all build files -->
  <target
      name="clean"
      description="Clean up build files">

    <echo message="Cleaning up build files..."/>

    <!-- Delete the folder containing all build files -->
    <delete dir="${build}"/>
  </target>

    <!-- ====================================== -->
    <!-- Target: clean.small                    -->
    <!-- ====================================== -->

    <!-- Clean up all build files -->
    <target
        name="clean.small"
        description="Clean up build files">

      <echo message="Cleaning up build files..."/>

      <!-- Delete the folder containing all build files -->
      <delete dir="${build}/robocode"/>
      <delete dir="${build}/robocodeui"/>
      <delete dir="${build}/libs"/>
      <delete dir="${build}/nlibs/*.pdb"/>
      <delete dir="${build}/nlibs/robocode.exe"/>
      <delete dir="${build}/nlibs/roborumble.exe"/>
      <delete dir="${build}/nlibs/nrobocodeui.dll"/>
      <delete dir="${build}/nlibs/codesize.dll"/>
      <delete dir="${src.robocode}/bin"/>
      <delete dir="${src.robocodeui}/bin"/>
      <delete dir="${src.roborumble}/bin"/>
      <delete dir="${src.roborumble}/bin"/>
      <delete file="${build}/.robocode_build"/>
      <delete file="${build}/.robocodeui_build"/>
      <delete file="${build}/.cachecleaner_build"/>
      <delete file="${build}/.roborumble_build"/>
    </target>

  <!-- ====================================== -->
  <!-- Jacobe beautify                         -->
  <!-- ====================================== -->
  <taskdef name="jacobe" classname="com.tiobe.jacobe.JacobeTask" classpath="jacobe.jar"/>
  
  <target depends="init" name="jacobe">
	<jacobe input="${src.robocode}" cfg="robocode.cfg" overwrite="true" nobackup="true"/>
	<jacobe input="${src.robocodeui}" cfg="robocode.cfg" overwrite="true" nobackup="true"/>
  </target>
  

  <!-- ====================================== -->
  <!-- Macro: compile                         -->
  <!-- ====================================== -->
  <macrodef name="compile">
    <attribute name="srcdir"/>
    <attribute name="destdir"/>
    <attribute name="classpath" default=""/>
    <sequential>
      <!-- Create folder for class files -->
      <mkdir dir="@{destdir}"/>
      <!-- Compile the sources -->
      <javac
          encoding="8859_1"
      	  srcdir="@{srcdir}"
          destdir="@{destdir}"
          classpath="@{classpath}"
          source="1.5"
          target="1.5"
          debug="${java.debug}"
          debuglevel="lines,vars,source"
          optimize="true"
          includes="**/*.java"
      />
    </sequential>
  </macrodef>


  <!-- ====================================== -->
  <!-- Target: codesize.dll                   -->
  <!-- ====================================== -->
  <target
      name="codesize.dll"
      description="Build codesize.dll"
      depends="init"
      unless="codesize.dll.uptodate">

    <echo message="Building codesize.dll..."/>

  	<copy file="${ikvm}/IKVM.OpenJDK.ClassLibrary.dll" toDir="${build}/nlibs"/>
  	<copy file="${ikvm}/IKVM.Runtime.dll" toDir="${build}/nlibs"/>
    <copy file="${ikvm}/ICSharpCode.SharpZipLib.dll" toDir="${build}/nlibs"/>
    
    <!-- 
    <copy file="${ikvm}/IKVM.OpenJDK.ClassLibrary.pdb" toDir="${build}/nlibs"/>
    <copy file="${ikvm}/IKVM.Runtime.pdb" toDir="${build}/nlibs"/>
    -->

    <!-- Create the codesize.dll file -->
	<exec executable="${ikvm}/ikvmc.exe">
		<arg value="${ikvm.debug}"/>
		<arg value="-target:library"/>
        <arg value="${ikvm.sign}"/>
		<arg value="${build}/libs/codesize.jar"/>
		<arg value="-out:${build}/nlibs/codesize.dll"/>
	</exec>    
  </target>

  <!-- ====================================== -->
  <!-- Target: robocode.exe                   -->
  <!-- ====================================== -->
  <target
      name="robocode.exe"
      description="Build robocode.exe"
      depends="init, robocode.jar, codesize.dll"
      unless="robocode.exe.uptodate">

    <echo message="Building robocode.exe..."/>

    <!-- Create the robocode.exe file -->
	<exec executable="${ikvm}/ikvmc.exe">
		<arg value="${ikvm.debug}"/>
        <arg value="${ikvm.sign}"/>
		<arg value="-target:exe"/>
		<arg value="-reference:${build}/nlibs/codesize.dll"/>
		<arg value="${build}/libs/robocode.jar"/>
		<arg value="-main:robocode.Robocode"/>
		<arg value="-out:${build}/nlibs/robocode.exe"/>
	</exec>    
  </target>

  <!-- ====================================== -->
  <!-- Target: roborumble.exe                   -->
  <!-- ====================================== -->
  <target
      name="roborumble.exe"
      description="Build roborumble.exe"
      depends="init, robocode.exe, roborumble.jar"
      unless="roborumble.exe.uptodate">

    <echo message="Building roborumble.exe..."/>

    <!-- Create the roborumble.exe file -->
	<exec executable="${ikvm}/ikvmc.exe">
		<arg value="${ikvm.debug}"/>
        <arg value="${ikvm.sign}"/>
		<arg value="-target:exe"/>
		<arg value="-reference:${build}/nlibs/codesize.dll"/>
		<arg value="-reference:${build}/nlibs/robocode.exe"/>
		<arg value="${build}/libs/roborumble.jar"/>
		<arg value="-main:roborumble.RoboRumbleAtHome"/>
		<arg value="-out:${build}/nlibs/roborumble.exe"/>
	</exec>    
  </target>

  <!-- ====================================== -->
  <!-- Target: nrobocode                      -->
  <!-- ====================================== -->
  <target
      name="nrobocode"
      description="Build nrobocode"
      depends="init, robocode.exe, roborumble.exe"
      unless="codesize.dll.uptodate">

    <echo message="Building nrobocode..."/>

    <!-- Create the nrobocode file -->
	<exec executable="${vs9}">
		<arg value="${src.root}/nrobocode.sln"/>
		<arg value="/Rebuild"/>
	</exec>    
  </target>




</project>